(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     15653,        413]
NotebookOptionsPosition[     15316,        396]
NotebookOutlinePosition[     15674,        412]
CellTagsIndexPosition[     15631,        409]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pathFinder", "=", 
    RowBox[{"N", " ", "\[Function]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"pack", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "r", ",", " ", "N"}], "}"}], " ", 
         "\[Function]", 
         RowBox[{"{", 
          RowBox[{"x", ",", "y", ",", "r", ",", "N"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"getX", " ", "=", " ", 
        RowBox[{"r", " ", "\[Function]", 
         RowBox[{"r", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"getY", " ", "=", " ", 
        RowBox[{"r", " ", "\[Function]", 
         RowBox[{"r", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"getR", " ", "=", " ", 
        RowBox[{"r", " ", "\[Function]", 
         RowBox[{"r", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"getN", " ", "=", " ", 
        RowBox[{"r", " ", "\[Function]", 
         RowBox[{"r", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"r", "=", 
        RowBox[{"pack", "[", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", "N"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"canRight", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getX", "[", "r", "]"}], " ", "<", " ", 
             RowBox[{"getN", "[", "r", "]"}]}], ",", " ", "True", ",", " ", 
            "False"}], "]"}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"canDown", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getY", "[", "r", "]"}], "<", 
             RowBox[{"getN", "[", "r", "]"}]}], ",", "True", ",", " ", 
            "False"}], "]"}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"moveRight", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"pack", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"getX", "[", "r", "]"}], " ", "+", " ", "1"}], ",", 
            RowBox[{"getY", "[", "r", "]"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"getR", "[", "r", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"getX", "[", "r", "]"}], "+", "1"}], ",", 
                RowBox[{"getY", "[", "r", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"getN", "[", "r", "]"}]}], "]"}], "\[IndentingNewLine]", 
          ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"moveDown", " ", "=", " ", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{"pack", "[", 
           RowBox[{
            RowBox[{"getX", "[", "r", "]"}], ",", " ", 
            RowBox[{
             RowBox[{"getY", "[", "r", "]"}], "+", "1"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"getR", "[", "r", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"getX", "[", "r", "]"}], ",", 
                RowBox[{
                 RowBox[{"getY", "[", "r", "]"}], "+", "1"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{"getN", "[", "r", "]"}]}], "]"}], "\[IndentingNewLine]", 
          ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"moveDiagonaleDown", "=", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", "=", " ", 
            RowBox[{"getX", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"y", " ", "=", " ", 
            RowBox[{"getY", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", ">", "1"}], "&&", 
              RowBox[{"canDown", "[", "r", "]"}]}], ",", " ", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"x", " ", "=", " ", 
                RowBox[{"x", "-", "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"y", " ", "=", " ", 
                RowBox[{"y", "+", "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"result", "=", 
                RowBox[{"pack", "[", 
                 RowBox[{"x", ",", "y", ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"getR", "[", "r", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
                  RowBox[{"getN", "[", "r", "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"moveDiagonaleDown", "[", "result", "]"}]}], 
              "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", "r"}],
             "]"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"moveDiagonaleUp", "=", 
        RowBox[{
         RowBox[{"{", "r", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"x", "=", " ", 
            RowBox[{"getX", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"y", " ", "=", " ", 
            RowBox[{"getY", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"y", ">", "1"}], "&&", 
              RowBox[{"canRight", "[", "r", "]"}]}], ",", " ", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"x", " ", "=", " ", 
                RowBox[{"x", "+", "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"y", " ", "=", " ", 
                RowBox[{"y", "-", "1"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"result", "=", 
                RowBox[{"pack", "[", 
                 RowBox[{"x", ",", "y", ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"getR", "[", "r", "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"x", ",", "y"}], "}"}]}], "]"}], ",", 
                  RowBox[{"getN", "[", "r", "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"moveDiagonaleUp", "[", "result", "]"}]}], 
              "\[IndentingNewLine]", ")"}], ",", "\[IndentingNewLine]", "r"}],
             "]"}]}], "\[IndentingNewLine]", ")"}]}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"traverse", "=", 
        RowBox[{
         RowBox[{"{", "res", "}"}], "\[Function]", 
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"r", " ", "=", " ", "res"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"canRight", "[", "r", "]"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"r", "=", 
                RowBox[{"moveRight", "[", "r", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{"moveDiagonaleDown", "[", "r", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"canDown", "[", "r", "]"}], ",", 
                  RowBox[{"moveDown", "[", "r", "]"}], ",", 
                  RowBox[{"moveRight", "[", "r", "]"}]}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"r", "=", 
                RowBox[{"moveDiagonaleUp", "[", "r", "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"traverse", "[", "r", "]"}]}], "\[IndentingNewLine]", 
              ")"}], ",", 
             RowBox[{"(", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"canDown", "[", "r", "]"}], ",", 
                RowBox[{"(", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"r", "=", 
                   RowBox[{"moveDown", "[", "r", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"r", "=", 
                   RowBox[{"moveDiagonaleDown", "[", "r", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"r", "=", 
                   RowBox[{"moveRight", "[", "r", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"r", "=", 
                   RowBox[{"moveDiagonaleUp", "[", "r", "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"traverse", "[", "r", "]"}]}], 
                 "\[IndentingNewLine]", ")"}], ",", "r"}], "]"}], 
              "\[IndentingNewLine]", ")"}]}], "]"}]}], "\[IndentingNewLine]", 
          ")"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"r", " ", "=", " ", 
        RowBox[{"traverse", "[", "r", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"getR", "[", "r", "]"}]}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"pathFinder", "[", "8", "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0FtIkwEYxvH5oRiUwqJS0pTETEgmCdHB0EY13YyVOrsQDFrNiROMCEWJ
XchSY7JF8JUpHpDSbCqoTSO9WJBJjhUatbIYYqIxPF10UvJb/r+Ll9/V8zzw
HjRWFpgEhUKRsn14T1VycuVBUB1++mIuvsgIXMWsxHErflLY7qPu3ehTrCj2
9aFnOSQ7d31+CMVeixuFOGkMU23WGdyKqPbjM69zFic6Ps+jpJxeRO/U4b94
7lWXcnXbwO6EfdgtnM1CoTeYg1/0A1p8GFaaj5HPxVvY2WOyY531mBOj80Zb
5Z4L+7txV86Nb2j7c/4H1kv+ZVyIcYSvsVPbtQMHogwq1D/yHce3bekavFkh
6vBaod2EgbpQOZodzRZUOrxVcv6AuREXI3QOVMePi5imvdyOLYPJPXinwejB
puGkNUxxjvzEqk3tBg5fUoXk3sm06HX+eKUsBjOM/XH4uHU2Gf01jakoSr+O
ou5DVCZOufKzseZr5Rl8kq3R4InSftmCrUMGzPz+rwj37PxoxtsuTz1OLpTb
sTj3dQverXV3oPDS14edR6QJjH3veoOnlixe1M+UzWH6Xo3/d3NQ7Q4YZP8D
UvVniw==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.568797292954174*^9, 3.568797444132512*^9}, 
   3.5688983766442337`*^9, 3.569858235693351*^9}]
}, Open  ]]
},
WindowSize->{740, 756},
WindowMargins->{{535, Automatic}, {Automatic, 107}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 10773, 237, 1138, "Input"],
Cell[11355, 261, 3945, 132, 103, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
